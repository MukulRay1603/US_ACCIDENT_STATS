This is an update from the Colab notebook.